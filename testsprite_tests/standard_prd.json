{
  "meta": {
    "project": "PlanetaZEGA",
    "date": "2025-12-22",
    "prepared_by": "Generated by Software Development Manager"
  },
  "product_overview": "PlanetaZEGA is a comprehensive kiosk management system designed to streamline sales, inventory, employee management, cash control, and reporting. Built with modern web technologies including Next.js, TypeScript, and Supabase backend, the platform offers a multi-role environment (owner and employee) with advanced features such as gamification, multi-branch support, and automated discount mechanisms.",
  "core_goals": [
    "Enable kiosk owners to efficiently manage products, inventory, and sales.",
    "Provide a robust user authentication and role-based access control system.",
    "Facilitate employee management including attendance, performance tracking, and task assignments.",
    "Support accurate daily cash management with automated reconciliation features.",
    "Integrate a gamification system to motivate employee productivity and engagement.",
    "Allow management of multiple branches with centralized oversight.",
    "Offer additional services like public transport card recharge and promotional discounts."
  ],
  "key_features": [
    "Secure authentication system with roles for owners and employees, including invitation-based employee registration via magic links.",
    "Comprehensive product CRUD with barcode scanning, categorization, price and cost management.",
    "Inventory management that handles stock inflows, outflows, expiration tracking, and critical stock alerts.",
    "Full POS system supporting barcode scanning, multiple payment methods, and automatic stock updates.",
    "Daily cash register operations including opening, closing, cash counting, and money movement records.",
    "Supplier management featuring CRUD, purchase logging, and balance controls.",
    "Branch management enabling multiple branch setups and stock segregation per branch.",
    "Gamified employee missions with XP, points, and rankings to boost engagement.",
    "Additional services such as SUBE card recharge and automated Happy Hour discounts for critical stock products.",
    "Employee attendance tracking with clock-in/out functionality."
  ],
  "user_flow_summary": [
    "Owner registration leads to organization creation and branch setup followed by inviting employees.",
    "Employees accept invitations through magic links, complete their profiles, and select branches to access role-specific dashboards.",
    "Daily cash operations flow from opening the register, conducting sales, to closing and performing cash reconciliations.",
    "Product lifecycle flow from creation, stock addition, sales processing, to stock updates.",
    "Supplier and purchase management from provider setup to purchase registration and stock integration."
  ],
  "validation_criteria": [
    "System enforces role-based access control with secure authentication.",
    "All product and inventory operations reflect accurately in the database with real-time updates.",
    "Cash management features correctly calculate balances, handle discrepancies, and maintain a reliable audit trail.",
    "Employee missions update XP and rankings correctly and reflect in dashboards.",
    "Multi-branch and multi-user data segregation is maintained with Row Level Security.",
    "POS transactions must integrate flawlessly with inventory and stock status.",
    "UI components must adhere to accessibility and responsiveness standards.",
    "All critical user flows are covered by automated end-to-end tests ensuring system stability and usability."
  ],
  "code_summary": {
    "project_name": "PlanetaZEGA",
    "description": "Sistema de gestión de kioscos con funcionalidades de venta, inventario, gestión de empleados y reportes",
    "tech_stack": {
      "framework": "Next.js 16.0.10",
      "language": "TypeScript",
      "runtime": "Node.js >=18.0.0 <23.0.0",
      "database": "Supabase (PostgreSQL)",
      "authentication": "Supabase Auth",
      "ui_library": "React 19.2.0",
      "styling": "Tailwind CSS",
      "ui_components": "Radix UI",
      "forms": "react-hook-form + zod",
      "state_management": "React Hooks",
      "deployment": "Vercel"
    },
    "main_features": [
      {
        "name": "Autenticación y Perfiles",
        "description": "Sistema de autenticación con roles (dueño/empleado), registro de empleados mediante invitaciones",
        "components": [
          "auth-form.tsx",
          "profile-setup.tsx",
          "invitar-empleado.tsx"
        ],
        "routes": [
          "/",
          "/login"
        ]
      },
      {
        "name": "Dashboard de Dueño",
        "description": "Panel principal para administradores con gestión completa del negocio",
        "components": [
          "dashboard-dueno.tsx"
        ],
        "routes": [
          "/"
        ]
      },
      {
        "name": "Vista de Empleado",
        "description": "Interfaz para empleados con funciones de venta y misiones",
        "components": [
          "vista-empleado.tsx"
        ],
        "routes": [
          "/"
        ]
      },
      {
        "name": "Gestión de Productos",
        "description": "CRUD completo de productos con códigos de barras, categorías, precios y costos",
        "components": [
          "crear-producto.tsx",
          "dashboard-dueno.tsx"
        ],
        "routes": [
          "/"
        ]
      },
      {
        "name": "Gestión de Stock",
        "description": "Control de inventario con entradas, salidas, vencimientos y stock crítico",
        "components": [
          "agregar-stock.tsx",
          "gestion-vencimientos.tsx"
        ],
        "routes": [
          "/"
        ]
      },
      {
        "name": "Ventas",
        "description": "Sistema de punto de venta con escáner de código de barras, múltiples métodos de pago",
        "components": [
          "caja-ventas.tsx"
        ],
        "routes": [
          "/"
        ]
      },
      {
        "name": "Gestión de Caja",
        "description": "Apertura/cierre de caja diaria, arqueo, movimientos de dinero (ingresos/egresos)",
        "components": [
          "arqueo-caja.tsx",
          "registrar-movimientos.tsx",
          "registrar-gasto.tsx"
        ],
        "routes": [
          "/"
        ]
      },
      {
        "name": "Gestión de Proveedores",
        "description": "Administración de proveedores con control de saldos y compras",
        "components": [
          "gestion-proveedores.tsx",
          "control-saldo-proveedor.tsx"
        ],
        "routes": [
          "/"
        ]
      },
      {
        "name": "Gestión de Sucursales",
        "description": "Administración de múltiples sucursales por organización",
        "components": [
          "gestion-sucursales.tsx",
          "seleccionar-sucursal.tsx"
        ],
        "routes": [
          "/"
        ]
      },
      {
        "name": "Sistema de Misiones",
        "description": "Gamificación con misiones para empleados, XP, puntos y ranking",
        "components": [
          "misiones-empleado.tsx",
          "asignar-mision.tsx",
          "team-ranking.tsx"
        ],
        "routes": [
          "/"
        ]
      },
      {
        "name": "Servicios Adicionales",
        "description": "Venta de servicios y recarga SUBE",
        "components": [
          "widget-servicios.tsx",
          "widget-sube.tsx"
        ],
        "routes": [
          "/"
        ]
      },
      {
        "name": "Happy Hour",
        "description": "Sistema de descuentos automáticos para productos con stock crítico",
        "components": [
          "happy-hour.tsx"
        ],
        "routes": [
          "/"
        ]
      },
      {
        "name": "Control de Asistencia",
        "description": "Fichaje de entrada/salida de empleados",
        "components": [
          "reloj-control.tsx"
        ],
        "routes": [
          "/"
        ]
      }
    ],
    "database_schema": {
      "tables": [
        "organizations",
        "perfiles",
        "sucursales",
        "productos",
        "proveedores",
        "compras",
        "caja_diaria",
        "movimientos_caja",
        "stock",
        "misiones",
        "plantillas_misiones",
        "historial_precios",
        "asistencia",
        "pending_invites"
      ],
      "security": "Row Level Security (RLS) habilitado en todas las tablas"
    },
    "authentication_flow": {
      "methods": [
        "Email/Password",
        "Magic Link (OTP)"
      ],
      "roles": [
        "dueño",
        "empleado"
      ],
      "invitation_system": "Sistema de invitaciones mediante pending_invites"
    },
    "key_user_flows": [
      "Registro de dueño -> Crear organización -> Crear sucursales -> Invitar empleados",
      "Empleado recibe invitación -> Magic link -> Completar perfil -> Seleccionar sucursal -> Dashboard",
      "Abrir caja -> Registrar ventas -> Cerrar caja -> Arqueo",
      "Agregar productos -> Agregar stock -> Vender productos -> Actualizar stock",
      "Crear proveedor -> Registrar compra -> Agregar stock -> Controlar saldo"
    ],
    "entry_points": {
      "main_page": "/",
      "development_port": 3001,
      "base_url": "http://localhost:3001"
    },
    "testing_requirements": {
      "requires_authentication": true,
      "requires_database": true,
      "test_user_needed": true,
      "frontend_testing": true,
      "backend_testing": false
    }
  }
}
